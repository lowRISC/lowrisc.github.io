<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><base href=https://www.lowrisc.org><link rel=icon type=image/png sizes=32x32 href=/favicon.png><title>lowRISC&#43;IMC internship: second update &middot; lowRISC: Collaborative open silicon engineering</title><link href=/main.b716e.css rel=stylesheet></head><body><header><nav class="navbar navbar-expand-md navbar-light"><div class=container><a class=navbar-brand href=#><img src=/img/logo/logo-dualcolor.svg alt=lowRISC></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarCollapse><ul class="navbar-nav ml-auto"><li class=nav-item><a href=/our-work class=nav-link>Our work</a></li><li class=nav-item><a href=/open-silicon class=nav-link>Open Silicon</a></li><li class=nav-item><a href=/community class=nav-link>Community</a></li><li class=nav-item><a href=/blog class=nav-link>Blog</a></li><li class=nav-item><a href=/jobs class=nav-link>Jobs</a></li><li class=nav-item><a href=/about class=nav-link>About us</a></li><li class=nav-item><a class="btn lr-navbar-btn-gh" href=https://github.com/lowrisc>GitHub</a></li></ul></div></div></nav></header><main role=main><div class="container lr-blog"><article><h1>lowRISC&#43;IMC internship: second update</h1><address class=lr-blog-author><time>July 27, 2016</time></address><p><em>This is the second update from our team of interns, comprised of four
University of Cambridge undergrads. Their work is kindly sponsored by <a href=http://www.imc.nl/>IMC
Financial Markets</a> who are also helping to advise this
summer project.</em></p><p>At the time of our <a href=https://www.lowrisc.org/blog/2016/07/lowrisc-/-imc-internship-week-one-vga-output/>last blog post</a>, we had just finished VGA and
were working on implementing the frame buffer. Over the last 2 weeks, we have
made significant progress, completing the frame buffer and starting video decode.</p><p>The frame buffer was developed iteratively. Initially, it was a small Block RAM
attached to the SoC&rsquo;s AXI-Lite bus. This was useful for creating a prototype,
but its limited size lead to it being replaced with an in-memory frame buffer,
supplemented with a BRAM line buffer. The end result is shown below, the
component is connected to the TileLink bus.</p><img srcset="https://www.lowrisc.org/blog/2016/07/lowriscimc-internship-second-update/imc_2ndupd_framebuffer_hu242dcfbcd62d5e4fc74614622ef16f28_42322_300x0_resize_box_2.png 1x, https://www.lowrisc.org/blog/2016/07/lowriscimc-internship-second-update/imc_2ndupd_framebuffer_hu242dcfbcd62d5e4fc74614622ef16f28_42322_600x0_resize_box_2.png 2x" src=https://www.lowrisc.org/blog/2016/07/lowriscimc-internship-second-update/imc_2ndupd_framebuffer_hu242dcfbcd62d5e4fc74614622ef16f28_42322_300x0_resize_box_2.png alt="Framebuffer diagram" title="Framebuffer diagram" class="m-2 d-block mx-auto"><p>This component builds on the VGA controller, for which documentation will be
added shortly. We have added a data mover (a unidirectional DMA), to move data
from the in memory frame buffer into the local video memory. The video memory
acts as a line buffer, the data mover (DM) moves one line from the in-memory frame
buffer at a time. Meanwhile the VGA controller flushes the new lines to the
screen, displaying the image from memory. The DM obeys the state machine shown
in the diagram below. The DM Controller is memory mapped, allowing the CPU to
communicate with it. Currently, it can only accept one request at a time,
further requests are ignored until the component moves back to the IDLE step.
Requests consist of source and destination addresses, and a length. A planned
extension is adding a FIFO queue to the controller to allow multiple requests
to be supported.</p><img srcset="https://www.lowrisc.org/blog/2016/07/lowriscimc-internship-second-update/imc_2ndupd_dm_states_hu497ba94ea07cdf1246499c8cae046845_21549_400x0_resize_box_2.png 1x, https://www.lowrisc.org/blog/2016/07/lowriscimc-internship-second-update/imc_2ndupd_dm_states_hu497ba94ea07cdf1246499c8cae046845_21549_800x0_resize_box_2.png 2x" src=https://www.lowrisc.org/blog/2016/07/lowriscimc-internship-second-update/imc_2ndupd_dm_states_hu497ba94ea07cdf1246499c8cae046845_21549_400x0_resize_box_2.png alt="Data mover state diagram" title="Data mover state diagram" class="m-2 d-block mx-auto"><p>The decision was made to implement a unidirectional data mover over a more
complex and capable bidirectional DMA component as only unidirectional movement
was needed for now. Later on, we will need bidirectional access as the
video accelerator will need to write back to memory. We hope to enable
bidirectionality by simply duplicating the existing unidirectional design.</p><p>Our next tasks relate to video decoding. We will be adapting a reference
MPEG-2 codec to decode video on the FPGA and adding extra components to the
SoC design to improve the performance of the codec, such as DCT and iDCT
accelerators.</p></article></div></main><footer class=lr-footer><div class=container><div class=row><div class="col-lg-2 d-none d-lg-block"><img src=/img/logo/logo-dualcolor.svg width=150px></div><div class=col><p><small>The text content on this website is licensed under a <a href=https://creativecommons.org/licenses/by/4.0/>Creative Commons Attribution 4.0 International License</a>, except where otherwise noted. No license is granted for logos or other trademarks. Other content &copy; lowRISC Contributors.</small></p><p><small><a href=/privacy-policy>Privacy and cookies policy</a>
&middot; <a href=/usage-licence>Usage licence</a></small></p></div><div class=col-lg-2><p><a href=#>Back to top</a></p></div></div></div></footer><script src=/main.b716e.js></script></body></html>