<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><base href=https://www.lowrisc.org><link rel=icon type=image/png sizes=32x32 href=/favicon.png><title>lowRISC Refresh internals &middot; lowRISC: Collaborative open silicon engineering</title><link href=/main.e2036.css rel=stylesheet><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-53520714-1','auto');ga('send','pageview');</script></head><body><header><nav class="navbar navbar-expand-md navbar-light"><div class=container><a class=navbar-brand href=#><img src=/img/logo/logo-dualcolor.svg alt=lowRISC></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarCollapse aria-controls=navbarCollapse aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarCollapse><ul class="navbar-nav ml-auto"><li class=nav-item><a href=/our-work class=nav-link>Our work</a></li><li class=nav-item><a href=/open-silicon class=nav-link>Open Silicon</a></li><li class=nav-item><a href=/community class=nav-link>Community</a></li><li class=nav-item><a href=/blog class=nav-link>Blog</a></li><li class=nav-item><a href=/jobs class=nav-link>Jobs</a></li><li class=nav-item><a href=/about class=nav-link>About us</a></li><li class=nav-item><a class="btn lr-navbar-btn-gh" href=https://github.com/lowrisc>GitHub</a></li></ul></div></div></nav></header><main role=main><div class=container><h1>lowRISC Refresh internals</h1><p>This lowRISC release introduces refresh debugging and compressed instructions, allowing upstream debian Linux distribution to be used.</p><h2 id=rtl-changes:0d68dae554c1f78133b40bb136574e92>RTL changes</h2><p>The JTAG uses Xilinx built-in instruction register of 6 bits and available user data registers.
These data register numbers deviate from the RISC-V specification but otherwise conforms to the Berkeley Rocket standard.
This deviation eliminates the requirement for separate hardware to implement the debug interface and keeps costs low,
allowing the same board (Nexys4DDR) as previously to be used.
The impact on the Chisel is restricted to a small part which invokes BSCANE2 as a primitive.</p><table><thead><tr><th>Function</th><th align=center><em>Berkeley Rocket</em></th><th align=center><em>LowRISC Rocket</em></th></tr></thead><tbody><tr><td>Manufacturer code</td><td align=center>all</td><td align=center>0x49</td></tr><tr><td>IR length</td><td align=center>5</td><td align=center>6</td></tr><tr><td>IDCODE</td><td align=center>0x01</td><td align=center>0x09</td></tr><tr><td>DTM_CONTROL</td><td align=center>0x10</td><td align=center>0x22</td></tr><tr><td>DTM_DMI</td><td align=center>0x11</td><td align=center>0x23</td></tr></tbody></table><p>This functionality needs to be supported with appropriate TCL which, in the case of Nexys4DDR will be:</p><pre><code>interface ftdi
ftdi_device_desc &quot;Digilent USB Device&quot;
ftdi_vid_pid 0x0403 0x6010

ftdi_channel 0
ftdi_layout_init 0x0088 0x008b
ftdi_tdo_sample_edge falling

reset_config none
adapter_khz 10000
transport select jtag

jtag newtap riscv cpu -irlen 6 -expected-id 0x13631093

target create riscv.cpu riscv -chain-position riscv.cpu
</code></pre><h2 id=linux-driver:0d68dae554c1f78133b40bb136574e92>Linux driver</h2><p>The JTAG does not impact on Linux operation. Extra facilities are available if KGDB is compiled in and it is not clear what the virtual memory approach will be in GDB at the moment.</p><h2 id=user-land-operation:0d68dae554c1f78133b40bb136574e92>User land operation</h2><p>A complete suite of Linux user commands is available via the Debian Linux distribution for RISCV. There is not necessity for the distribution to be built from scratch.</p><h2 id=remote-booting:0d68dae554c1f78133b40bb136574e92>Remote booting</h2><p>All the booting methods of the previous release are possible but for debugging most users will find it convenient to just load BBL with Linux appended inside GDB.</p></div></main><footer class=lr-footer><div class=container><div class=row><div class="col-lg-2 d-none d-lg-block"><img src=/img/logo/logo-dualcolor.svg width=150px></div><div class=col><p>The text content on this website is licensed under a <a href=https://creativecommons.org/licenses/by/4.0/>Creative Commons Attribution 4.0 International License</a>, except where otherwise noted. No license is granted for logos or other trademarks. Other content &copy; lowRISC Contributors.</p><a href=/privacy-policy>Privacy and cookies policy</a>
&middot; <a href=/usage-licence>Usage licence</a></p></div><div class=col-lg-2><p><a href=#>Back to top</a></p></div></div></div></footer><script src=/main.e2036.js></script></body></html>